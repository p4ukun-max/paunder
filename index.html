<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
<title>Paunder - Encuentra el amor</title>

<style>
*{box-sizing:border-box;margin:0;padding:0}
html,body{
  width:100%;
  overflow-x:hidden; height:100%;background:#000;color:white;font-family:Inter,system-ui,Arial;display:flex;justify-content:center;}
.app{
  width:100vw;
  height:100vh;
  display:flex;
  flex-direction:column;
  overflow:hidden;
}
/* HEADER */
header{padding:14px;display:flex;align-items:center;justify-content:space-between;font-weight:700;}
#backBtn{font-size:1.5rem;cursor:pointer;display:none;}

/* DECK */
.deck{
  flex:1;
  position:relative;
  display:flex;
  justify-content:center;
  align-items:center;
  overflow:hidden;
}

.card{
  position:absolute;
  width:100%;
  max-width:420px;
  height:70vh;
  left:50%;
  top:0;
  transform:translateX(-50%);
  overflow:hidden;
  background:#000;
  touch-action:none;
}
.card img{
  position:absolute;
  inset:0;
  height:100%;
  object-fit:cover;        /* llena la card */
  object-position:center; /* centrada */
  display:block;
}
.overlay{
  position:absolute;
  left:0;
  right:0;
  bottom:0;
  height:35%; /* SOLO la parte baja */
  background:linear-gradient(
    to top,
    rgba(0,0,0,0.95) 0%,
    rgba(0,0,0,0.75) 40%,
    rgba(0,0,0,0.3) 70%,
    rgba(0,0,0,0) 100%
  );
  color:#fff;
  padding-left:12px;
  padding-right:12px;  display:flex;
  flex-direction:column;
  justify-content:flex-end;
}
.name{
  font-size:1.6rem;
  font-weight:800;
  line-height:1.2;
}

.distance{
  font-size:.9rem;
  opacity:.85;
  margin:6px 0 10px;
}

.bio{
  font-size:1rem;
  line-height:1.35;
  opacity:.95;
  max-width:90%;     /* evita lÃ­neas eternas */
}
@media (max-height: 700px){
  .card{
    bottom:140px;
  }
}
/* CONTROLS */
.controls{padding:18px 0 26px;display:flex;justify-content:center;gap:26px;}
.circle-btn{width:64px;height:64px;border-radius:50%;border:none;font-size:1.6rem;cursor:pointer;}
.skip{background:#222;color:#ff4458}
.star{background:#222;color:#3b82f6}
.like{background:#222;color:#ff79c6}

/* BADGES */
.badge{position:absolute;top:24px;padding:6px 12px;font-weight:800;border-radius:8px;opacity:0;}
.like-badge{left:20px;background:#22c55e}
.skip-badge{right:20px;background:#ff4458}
.card[data-i="1"]{transform:scale(.97) translateY(8px);opacity:.9}
.card[data-i="2"]{transform:scale(.94) translateY(16px);opacity:.8}

/* CHAT LIST */
#chatListScreen,#chatWindow{display:none;flex-direction:column;flex:1;background:#111;overflow-y:auto;}
.chatItem{display:flex;padding:10px;border-bottom:1px solid #222;cursor:pointer;}
.chatItem img{width:40px;height:40px;border-radius:50%;margin-right:10px;}
.chatItem .info{flex:1;}
.chatItem .name{font-weight:bold;}
.chatItem .lastMsg{font-size:0.85rem;opacity:0.7;}

/* CHAT WINDOW */
#chatMsgs{flex:1;overflow-y:auto;padding:10px;}
.msg{margin:6px 0;padding:6px 10px;border-radius:16px;max-width:70%;}
.msg.yo{background:#ff79c6;align-self:flex-end;}
.msg.ella{background:#333;align-self:flex-start;}
#chatOpciones{display:flex;flex-direction:column;gap:6px;padding:10px;}
#chatInputWrapper{display:flex;padding:10px;}
#chatInput{flex:1;padding:6px 10px;border-radius:12px;border:none;}
#sendBtn{padding:6px 12px;margin-left:6px;border:none;border-radius:12px;background:#ff79c6;color:white;cursor:pointer;}
#logoTitle,
#chatsTitle{
  height:28px;
  object-fit:contain;
}

#textTitle{
  font-size:1.1rem;
  font-weight:700;
}
#matchOverlay{
  position:fixed;
  inset:0;
  background:black;
  z-index:99999;
  overflow:hidden;
}

#matchOverlay.hidden{
  display:none;
}

#matchOverlay img{
  width:100%;
  height:100%;
  object-fit:cover;
  filter:brightness(0.75);
}

.matchText{
  position:absolute;
  inset:0;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  text-align:center;
  animation:matchFade 0.8s ease-out;
}

.matchText h1{
  font-size:3.5rem;
  font-weight:900;
  letter-spacing:2px;
  text-shadow:0 4px 20px rgba(0,0,0,0.6);
}

.matchText p{
  margin-top:10px;
  font-size:1.2rem;
  opacity:0.9;
}

@keyframes matchFade{
  from{transform:scale(0.9);opacity:0}
  to{transform:scale(1);opacity:1}
}
</style>
</head>

<body>
<div class="app">

<header>
  <span id="backBtn">â†</span>
  <span id="headerTitle">
  <img id="logoTitle" src="img/logo.png" alt="Paunder">
  <img id="chatsTitle" src="img/mischats.png" alt="Mis Chats" style="display:none">
  <span id="textTitle" style="display:none"></span>
</span>
  <span><button id="goChats" style="background:none;border:none;color:white;cursor:pointer;">Chats</button></span>
</header>

<!-- DECK -->
<div class="deck" id="deck">
  <div class="badge like-badge" id="likeBadge">LIKE</div>
  <div class="badge skip-badge" id="skipBadge">NOPE</div>
</div>

<div class="controls" id="controls">
  <button class="circle-btn skip" id="btnSkip">âœ•</button>
  <button class="circle-btn like" id="btnLike">â™¥</button>
</div>

<!-- LISTA DE CHATS -->
<div id="chatListScreen"></div>

<!-- VENTANA DE CHAT -->
<div id="chatWindow">
  <div id="chatHeader" style="padding:10px;font-weight:bold;"></div>
  <div id="chatMsgs"></div>
  <div id="chatOpciones"></div>
  <div id="chatInputWrapper">
    <input id="chatInput" placeholder="Escribe...">
    <button id="sendBtn">Enviar</button>
  </div>
</div>

</div>
<!-- MATCH OVERLAY -->
<audio id="matchSound" src="paunder.mp3" preload="auto"></audio>

<div id="matchOverlay" class="hidden">
  <img id="matchImg">
  <div class="matchText">
    <h1>ğŸ’– Â¡MATCH! ğŸ’–</h1>
    <p>TenÃ©is conexiÃ³n</p>
  </div>
</div>
<script>
const logoTitle = document.getElementById("logoTitle");
const chatsTitle = document.getElementById("chatsTitle");
const textTitle = document.getElementById("textTitle");
function mostrarLogo(){
  logoTitle.style.display = "block";
  chatsTitle.style.display = "none";
  textTitle.style.display = "none";
}

function mostrarChatsImg(){
  logoTitle.style.display = "none";
  chatsTitle.style.display = "block";
  textTitle.style.display = "none";
}

function mostrarTextoTitulo(texto){
  logoTitle.style.display = "none";
  chatsTitle.style.display = "none";
  textTitle.style.display = "block";
  textTitle.innerText = texto;
}
/* ===================== DATOS ===================== */
const PERSONAJES=[
  {name:"Leonardo", age:36, distance:"14 km", bio:"Voy al gym casi todos los dÃ­as ğŸ’ª, levanto pesado y hago siempre la misma rutina.<br> Hablo poco ğŸ—¿, pienso menos. <br> Vivo de proteÃ­na, preentreno y frases hechas ğŸ¥¤.<br> No destaco por mis ideas pero soy constante y fÃ­sicamente fuerte ğŸ‹ï¸â€â™‚ï¸.", img:"img/gym1.png"},
  {name:"Dylan", age:25, distance:"45 km", bio:"ğŸŒŠ Socorrista de dÃ­a, buscador de aventuras de noche. <br> â˜€ï¸ Rubio, con amor por el sol, las olas y los atardeceres en la playa.<br> ğŸ„â€â™‚ï¸ Si sabes surfear, tenemos competencia; si no, te enseÃ±o. ğŸ¹ <br> Experto en hacer mojitos y rescatar sonrisas. <br> ğŸ’¬ Swipe right si quieres un compaÃ±ero para paseos en la arena y risas garantizadas.", img:"img/socorrista1.png"},
  {name:"Kaito (ä¸­æ‘)", age:22, distance:"20 km", bio:"ğŸ‡¯ğŸ‡µ Soy de Japon, trabajando en cafe tematico en Tokio.<br>âœˆï¸ Ahora en EspaÃ±a un tiempo, turismo y aprendiendo espaÃ±ol (aun es un poco difÃ­cil para mi ğŸ˜…). <br> Me gusta mucho servir cafe y hablar con clientes y es arte para mi. <br> LIKE si sabes sitios EspaÃ±aâ€¦ o ayudarme con espaÃ±ol ğŸ˜", img:"img/mayordomo1.png"},
  {name:"Pau Rivas", age:36, distance:"120 km", bio:"Trabajo salvando vidas, pero tambiÃ©n disfruto viajar, comer bien y desconectar del hospital. Busco conexiÃ³n real, risas honestas y alguien con quien sumar, no pasar el tiempo.", img:"img/medico1.png"},
  {name:"Jan", age:18, distance:"45 km", bio:"Estudiando para exÃ¡menes pero listo para planes espontÃ¡neos ğŸ˜Œ <br> Fan de las noches largas, memes malos y risas reales Swipe si te gusta reÃ­rte de la vida (y de los lunes).", img:"img/estudiante1.png"},
  {name:"Park Paujin", age:32, distance:"140 km", bio:"Hago mÃºsica ğŸ§ğŸ¶, escucho K-pop ğŸ’¿âœ¨ y probablemente te dedicarÃ­a una canciÃ³n sin avisar ğŸ’ŒğŸµ <br> Busco a alguien que vibre conmigo ğŸ’«, aunque sea fuera de tempo â³ğŸ¼ <br> Bonus si cantas en el coche ğŸš—ğŸ¤", img:"img/kpoper1.png"},
  {name:"Raven Teo", age:25, distance:"140 km", bio:"No me gustan los chistes ni la gente que los usa para evitar decir algo real. Prefiero el silencio, las conversaciones profundas y la honestidad brutal.", img:"img/gotico2.png"}
];

const eleccionesPorPerfilFinalMalo = {
  "Leonardo":[
    {pregunta:"No eres lo que busco. Suerte.", opciones:[
      {texto:"Que te vaya bonito", efecto:5},
      {texto:"Mejor ve a impresionar a otra saco de musculos", efecto:-5}
    ]}
  ],
  "Dylan":[
   {pregunta:"Gracias por el match y por escribir. Me pareciste muy simpÃ¡tica, pero no siento la conexiÃ³n que busco. Te deseo lo mejor ğŸ˜Š", opciones:[
    {texto:"Mejor es que yo prefiero a los chicos morenos la verdad"},
    {texto:"Solo no coincidimos en gustos, el marisco, la playa y el alcohol no me van..."},
    {texto:"Bueno vale", efecto:-10, siguiente:"No es eso... solo era una excusa para hablar... ğŸ˜… "}
  ]}
  ],
  "Kaito":[
    {pregunta:"Gracias por la conversaciÃ³n ğŸ™‡â€â™‚ï¸ <br>Pero creo que no somos buena combinaciÃ³n. <br>Prefiero terminar aquÃ­.", opciones:[
      {texto:"Ok aprende a hablar", efecto:10},
      {texto:"Un placer", efecto:-5}
    ]}
  ],
  "Pau Rivas":[
    {pregunta:"Gracias por escribir. Entre guardias, viajes pendientes y ganas de disfrutar una buena comida sin prisas, he aprendido a valorar mucho mi tiempo y mi energÃ­a. Busco una conexiÃ³n que sume de verdad, con risas fÃ¡ciles y complicidad natural, y en este caso no siento que estemos en el mismo punto.<br>Te deseo lo mejor y que encuentres a alguien con quien esa conexiÃ³n fluya sin esfuerzo.", opciones:[
      {texto:"De acuerdo lo entiendo", efecto:-1000},
      {texto:"Mucho texto bye", efecto:-1000}
    ]},
	
  "Pau Rivas":[
    {pregunta:"Gracias por escribir. Entre guardias, viajes pendientes y ganas de disfrutar una buena comida sin prisas, he aprendido a valorar mucho mi tiempo y mi energÃ­a. Busco una conexiÃ³n que sume de verdad, con risas fÃ¡ciles y complicidad natural, y en este caso no siento que estemos en el mismo punto.<br>Te deseo lo mejor y que encuentres a alguien con quien esa conexiÃ³n fluya sin esfuerzo.", opciones:[
      {texto:"De acuerdo lo entiendo", efecto:-1000},
      {texto:"Mucho texto bye", efecto:-1000}
    ]}
  ]
};
const eleccionesPorPerfil = {
  "Dylan":[
   {pregunta:"Hola, Â¿sabes nadar o voy a tener que salvarte yo?", opciones:[
    {texto:"MÃ¡s o menosâ€¦ dependo de mi flotador.", efecto:5, siguiente: "Jajaja, entonces tu flotador es tu hÃ©roe secreto ğŸ˜ "},
    {texto:"No se nadar, asÃ­ que tendrÃ¡s que mantenerme a floteâ€¦ y de paso, darme tu nÃºmero.", efecto:10, siguiente: "Creo que puedo hacer ambas cosas ğŸ˜‰ "},
    {texto:"Â¿Por ser una chica necesito que me salven? Quien te crees...", efecto:-10, siguiente:"No es eso... solo era una excusa para hablar... ğŸ˜… "}
  ]},
  {pregunta:"Â¿prefieres empezar en la piscina o en la playa?", opciones:[
    {texto:"Entrenamiento intenso suena bienâ€¦ siempre quise hacer que un socorrista corra detrÃ¡s de mÃ­", efecto:-10, siguiente: "Ya veo ğŸ¤· " },
    {texto:"Podemos ir a la piscinaâ€¦ aunque no prometo no ahogarme.", efecto:5, siguiente: "Bueno, la piscina entonces "},
    {texto:"La playa suena genial, asÃ­ puedo practicar nadar y reÃ­rme un poco contigo",efecto:10, siguiente: "Bueno, la playa entonces "}
  ]},
    {pregunta:"Pero cuidado, rescatar corazones es mÃ¡s difÃ­cil que nadar.", opciones:[
    {texto:"Espero que no sea demasiado difÃ­cil.", efecto:5, siguiente: "Soy un chico experimentado tu tranquila ğŸ˜Œ " },
    {texto:"Entonces me siento en buenas manos.", efecto:10, siguiente: "Â¿En serio lo crees? ğŸ’ª "},
    {texto:"Si me ahogo, al menos serÃ¡ dramÃ¡tico.", siguiente: "Bueno... â˜¹ï¸ " , efecto:-10}
  ]},
  {pregunta:"Â¿Y tÃº cÃ³mo decides si salvar a alguien o no?", opciones:[
    {texto:"Normalmente dejo que se hundanâ€¦ me divierto viÃ©ndolo.", efecto:-10, siguiente: "Mi trabajo es evitar que se hundan ğŸ˜… " },
    {texto:"Depende del humor del dÃ­a.", efecto:5, siguiente: "Comprendo. "},
    {texto:"Me guÃ­o por la sonrisaâ€¦ y creo que contigo ya hay motivo suficiente.", siguiente: "Que bueno ğŸ˜Š " , efecto:10}
  ]},
    {pregunta:"Eso suena peligrosoâ€¦ pero intrigante", opciones:[
    {texto:"Solo si hay alguien como tÃº cerca para rescatarme.", efecto:10, siguiente: "Jajaja ya veo, " },
    {texto:"Me gusta ver cÃ³mo otros se complican la vida", efecto:-10, siguiente: "Eso no es bueno... "},
    {texto:"Buenoâ€¦ un poco de riesgo no mata a nadie, Â¿no?", siguiente: "Supongo que tienes razÃ³n jajaja " , efecto:5}
  ]}
  ,
    {pregunta:"", opciones:[
    {texto:"Vale, pregunta importante: Â¿el rescate incluye mojitos despuÃ©s o eso va en un pack premium?", efecto:0, siguiente: "" }
  ]}
  ,
    {pregunta:"Incluye mojitos, pero solo si el rescate sale limpio ğŸ˜ŒğŸ¹ Â¿Confirmamos reserva o todavÃ­a estamos negociando condiciones? ğŸ˜", opciones:[
    {texto:"Confirmamos reserva ğŸ˜ Pero dejo claro el contrato: mojitos frÃ­os, pajita incluida y cero preguntas incÃ³modas despuÃ©s del rescate ğŸ¹ğŸ˜Œ", efecto:0, siguiente: "" }
  ]}
   ,
    {pregunta:"Entonces, plan cerrado: vamos a comer marisco frente al mar, sin prisas ni dramasâ€¦ y despuÃ©s te preparamos un mojito como recompensa oficial del rescate ğŸ¤ğŸŒŠğŸ¹. DifÃ­cil decir que no a eso, Â¿no?", opciones:[
    {texto:"Lo siento pero no me gusta el pescado", efecto:-30, siguiente: "Que pena entonces..." },
	{texto:"Trato hecho! Marisco frente al mar y luego mojito preparado con cariÃ±o ğŸ˜Š", efecto:20, siguiente: "Quedamos maÃ±ana en la playa donde hago guardia a la 13:00h. Te estarÃ© esperando ğŸ˜‰" },
	{texto:"No tomo alcohol pero por ti me emborracho jiji", efecto:5, siguiente: "Ah bueno... que rara pero esta bien supongo! " },
  ]}
  ],
  "Kaito (ä¸­æ‘)":[
    {pregunta:"Â¿QuÃ© te gusta hacer?", opciones:[
      {texto:"Ir al gimnasio", efecto:10},
      {texto:"Quedarme en casa", efecto:-5}
    ]}
  ],
  "Leonardo":[
    {pregunta:"Gracias por escribir. Entre guardias, viajes pendientes y ganas de disfrutar una buena comida sin prisas, he aprendido a valorar mucho mi tiempo y mi energÃ­a. Busco una conexiÃ³n que sume de verdad, con risas fÃ¡ciles y complicidad natural, y en este caso no siento que estemos en el mismo punto.<br>Te deseo lo mejor y que encuentres a alguien con quien esa conexiÃ³n fluya sin esfuerzo.", opciones:[
      {texto:"De acuerdo lo entiendo", efecto:-1000},
      {texto:"Mucho texto bye", efecto:-1000}
    ]}
  ]
};
const eleccionesPorPerfilFinalBueno = {
  "Dylan":[
   {pregunta:"Hola, Â¿sabes nadar o voy a tener que salvarte yo?", opciones:[
    {texto:"MÃ¡s o menosâ€¦ dependo de mi flotador.", efecto:5, siguiente: "Jajaja, entonces tu flotador es tu hÃ©roe secreto ğŸ˜ "},
    {texto:"No se nadar, asÃ­ que tendrÃ¡s que mantenerme a floteâ€¦ y de paso, darme tu nÃºmero.", efecto:10, siguiente: "Creo que puedo hacer ambas cosas ğŸ˜‰ "},
    {texto:"Â¿Por ser una chica necesito que me salven? Quien te crees...", efecto:-10, siguiente:"No es eso... solo era una excusa para hablar... ğŸ˜… "}
  ]},
  {pregunta:"Â¿prefieres empezar en la piscina o en la playa?", opciones:[
    {texto:"Entrenamiento intenso suena bienâ€¦ siempre quise hacer que un socorrista corra detrÃ¡s de mÃ­", efecto:-10, siguiente: "Ya veo ğŸ¤· " },
    {texto:"Podemos ir a la piscinaâ€¦ aunque no prometo no ahogarme.", efecto:5, siguiente: "Bueno, la piscina entonces "},
    {texto:"La playa suena genial, asÃ­ puedo practicar nadar y reÃ­rme un poco contigo",efecto:10, siguiente: "Bueno, la playa entonces "}
  ]},
    {pregunta:"Pero cuidado, rescatar corazones es mÃ¡s difÃ­cil que nadar.", opciones:[
    {texto:"Espero que no sea demasiado difÃ­cil.", efecto:5, siguiente: "Soy un chico experimentado tu tranquila ğŸ˜Œ " },
    {texto:"Entonces me siento en buenas manos.", efecto:10, siguiente: "Â¿En serio lo crees? ğŸ’ª "},
    {texto:"Si me ahogo, al menos serÃ¡ dramÃ¡tico.", siguiente: "Bueno... â˜¹ï¸ " , efecto:-10}
  ]},
  {pregunta:"Â¿Y tÃº cÃ³mo decides si salvar a alguien o no?", opciones:[
    {texto:"Normalmente dejo que se hundanâ€¦ me divierto viÃ©ndolo.", efecto:-10, siguiente: "Mi trabajo es evitar que se hundan ğŸ˜… " },
    {texto:"Depende del humor del dÃ­a.", efecto:5, siguiente: "Comprendo. "},
    {texto:"Me guÃ­o por la sonrisaâ€¦ y creo que contigo ya hay motivo suficiente.", siguiente: "Que bueno ğŸ˜Š " , efecto:10}
  ]},
    {pregunta:"Eso suena peligrosoâ€¦ pero intrigante", opciones:[
    {texto:"Solo si hay alguien como tÃº cerca para rescatarme.", efecto:10, siguiente: "Jajaja ya veo, " },
    {texto:"Me gusta ver cÃ³mo otros se complican la vida", efecto:-10, siguiente: "Eso no es bueno... "},
    {texto:"Buenoâ€¦ un poco de riesgo no mata a nadie, Â¿no?", siguiente: "Supongo que tienes razÃ³n jajaja " , efecto:5}
  ]}
  ,
    {pregunta:"", opciones:[
    {texto:"Vale, pregunta importante: Â¿el rescate incluye mojitos despuÃ©s o eso va en un pack premium?", efecto:0, siguiente: "" }
  ]}
  ,
    {pregunta:"Incluye mojitos, pero solo si el rescate sale limpio ğŸ˜ŒğŸ¹ Â¿Confirmamos reserva o todavÃ­a estamos negociando condiciones? ğŸ˜", opciones:[
    {texto:"Confirmamos reserva ğŸ˜ Pero dejo claro el contrato: mojitos frÃ­os, pajita incluida y cero preguntas incÃ³modas despuÃ©s del rescate ğŸ¹ğŸ˜Œ", efecto:0, siguiente: "" }
  ]}
   ,
    {pregunta:"Entonces, plan cerrado: vamos a comer marisco frente al mar, sin prisas ni dramasâ€¦ y despuÃ©s te preparamos un mojito como recompensa oficial del rescate ğŸ¤ğŸŒŠğŸ¹. DifÃ­cil decir que no a eso, Â¿no?", opciones:[
    {texto:"Lo siento pero no me gusta el pescado", efecto:-30, siguiente: "Que pena entonces..." },
	{texto:"Trato hecho! Marisco frente al mar y luego mojito preparado con cariÃ±o ğŸ˜Š", efecto:20, siguiente: "Quedamos maÃ±ana en la playa donde hago guardia a la 13:00h. Te estarÃ© esperando ğŸ˜‰" },
	{texto:"No tomo alcohol pero por ti me emborracho jiji", efecto:5, siguiente: "Ah bueno... que rara pero esta bien supongo! " },
  ]}
  ],
  "Kaito (ä¸­æ‘)":[
    {pregunta:"Â¿QuÃ© te gusta hacer?", opciones:[
      {texto:"Ir al gimnasio", efecto:10},
      {texto:"Quedarme en casa", efecto:-5}
    ]}
  ],
  "Leonardo":[
    {pregunta:"Fin de semana favorito?", opciones:[
      {texto:"Salir con amigos", efecto:5},
      {texto:"Quedarme en casa", efecto:-5}
    ]}
  ]
};
const eleccionesPorPerfilFinalAmigos = {
  "Dylan":[
   {pregunta:"Hola, Â¿sabes nadar o voy a tener que salvarte yo?", opciones:[
    {texto:"MÃ¡s o menosâ€¦ dependo de mi flotador.", efecto:5, siguiente: "Jajaja, entonces tu flotador es tu hÃ©roe secreto ğŸ˜ "},
    {texto:"No se nadar, asÃ­ que tendrÃ¡s que mantenerme a floteâ€¦ y de paso, darme tu nÃºmero.", efecto:10, siguiente: "Creo que puedo hacer ambas cosas ğŸ˜‰ "},
    {texto:"Â¿Por ser una chica necesito que me salven? Quien te crees...", efecto:-10, siguiente:"No es eso... solo era una excusa para hablar... ğŸ˜… "}
  ]},
  {pregunta:"Â¿prefieres empezar en la piscina o en la playa?", opciones:[
    {texto:"Entrenamiento intenso suena bienâ€¦ siempre quise hacer que un socorrista corra detrÃ¡s de mÃ­", efecto:-10, siguiente: "Ya veo ğŸ¤· " },
    {texto:"Podemos ir a la piscinaâ€¦ aunque no prometo no ahogarme.", efecto:5, siguiente: "Bueno, la piscina entonces "},
    {texto:"La playa suena genial, asÃ­ puedo practicar nadar y reÃ­rme un poco contigo",efecto:10, siguiente: "Bueno, la playa entonces "}
  ]},
    {pregunta:"Pero cuidado, rescatar corazones es mÃ¡s difÃ­cil que nadar.", opciones:[
    {texto:"Espero que no sea demasiado difÃ­cil.", efecto:5, siguiente: "Soy un chico experimentado tu tranquila ğŸ˜Œ " },
    {texto:"Entonces me siento en buenas manos.", efecto:10, siguiente: "Â¿En serio lo crees? ğŸ’ª "},
    {texto:"Si me ahogo, al menos serÃ¡ dramÃ¡tico.", siguiente: "Bueno... â˜¹ï¸ " , efecto:-10}
  ]},
  {pregunta:"Â¿Y tÃº cÃ³mo decides si salvar a alguien o no?", opciones:[
    {texto:"Normalmente dejo que se hundanâ€¦ me divierto viÃ©ndolo.", efecto:-10, siguiente: "Mi trabajo es evitar que se hundan ğŸ˜… " },
    {texto:"Depende del humor del dÃ­a.", efecto:5, siguiente: "Comprendo. "},
    {texto:"Me guÃ­o por la sonrisaâ€¦ y creo que contigo ya hay motivo suficiente.", siguiente: "Que bueno ğŸ˜Š " , efecto:10}
  ]},
    {pregunta:"Eso suena peligrosoâ€¦ pero intrigante", opciones:[
    {texto:"Solo si hay alguien como tÃº cerca para rescatarme.", efecto:10, siguiente: "Jajaja ya veo, " },
    {texto:"Me gusta ver cÃ³mo otros se complican la vida", efecto:-10, siguiente: "Eso no es bueno... "},
    {texto:"Buenoâ€¦ un poco de riesgo no mata a nadie, Â¿no?", siguiente: "Supongo que tienes razÃ³n jajaja " , efecto:5}
  ]}
  ,
    {pregunta:"", opciones:[
    {texto:"Vale, pregunta importante: Â¿el rescate incluye mojitos despuÃ©s o eso va en un pack premium?", efecto:0, siguiente: "" }
  ]}
  ,
    {pregunta:"Incluye mojitos, pero solo si el rescate sale limpio ğŸ˜ŒğŸ¹ Â¿Confirmamos reserva o todavÃ­a estamos negociando condiciones? ğŸ˜", opciones:[
    {texto:"Confirmamos reserva ğŸ˜ Pero dejo claro el contrato: mojitos frÃ­os, pajita incluida y cero preguntas incÃ³modas despuÃ©s del rescate ğŸ¹ğŸ˜Œ", efecto:0, siguiente: "" }
  ]}
   ,
    {pregunta:"Entonces, plan cerrado: vamos a comer marisco frente al mar, sin prisas ni dramasâ€¦ y despuÃ©s te preparamos un mojito como recompensa oficial del rescate ğŸ¤ğŸŒŠğŸ¹. DifÃ­cil decir que no a eso, Â¿no?", opciones:[
    {texto:"Lo siento pero no me gusta el pescado", efecto:-30, siguiente: "Que pena entonces..." },
	{texto:"Trato hecho! Marisco frente al mar y luego mojito preparado con cariÃ±o ğŸ˜Š", efecto:20, siguiente: "Quedamos maÃ±ana en la playa donde hago guardia a la 13:00h. Te estarÃ© esperando ğŸ˜‰" },
	{texto:"No tomo alcohol pero por ti me emborracho jiji", efecto:5, siguiente: "Ah bueno... que rara pero esta bien supongo! " },
  ]}
  ],
  "Kaito":[
    {pregunta:"Â¿QuÃ© te gusta hacer?", opciones:[
      {texto:"Ir al gimnasio", efecto:10},
      {texto:"Quedarme en casa", efecto:-5}
    ]}
  ],
  "Leonardo":[
    {pregunta:"Fin de semana favorito?", opciones:[
      {texto:"Salir con amigos", efecto:5},
      {texto:"Quedarme en casa", efecto:-5}
    ]}
  ]
};
function mostrarAnimacionMatch(perfil, callback){
  const overlay = document.getElementById("matchOverlay");
  const sound = document.getElementById("matchSound");
  const img = document.getElementById("matchImg");

  img.src = perfil.img;

  overlay.classList.remove("hidden");

  sound.currentTime = 0;
  sound.play().catch(()=>{});

  setTimeout(() => {
    overlay.classList.add("hidden");
    callback && callback();
  }, 2500);
}
/* ===================== VARIABLES ===================== */
const deck=document.getElementById("deck");
const likeBadge=document.getElementById("likeBadge");
const skipBadge=document.getElementById("skipBadge");
const controls=document.getElementById("controls");
const chatListScreen=document.getElementById("chatListScreen");
const chatWindow=document.getElementById("chatWindow");
const chatHeader=document.getElementById("chatHeader");
const chatMsgs=document.getElementById("chatMsgs");
const chatOpciones=document.getElementById("chatOpciones");
const chatInput=document.getElementById("chatInput");
const sendBtn=document.getElementById("sendBtn");
const backBtn=document.getElementById("backBtn");
const goChats=document.getElementById("goChats");
const headerTitle=document.getElementById("headerTitle");

let matches=[];
let chatActual=null;
let deckCards=[];

/* ===================== FUNCIONES ===================== */
function createDeck(){
  deck.innerHTML = "";
  deckCards = [];

  PERSONAJES.forEach(p => {
    if(yaTieneMatch(p.name)) return;

    const c = document.createElement("div");
    c.className = "card";
    c.innerHTML = `
      <img src="${p.img}">
      <div class="overlay">
        <div class="name">${p.name}, ${p.age}</div>
        <div class="distance">${p.distance} away</div>
        <div class="bio">${p.bio}</div>
      </div>
    `;
    deck.appendChild(c);
    drag(c, p);
    deckCards.push(c);
  });
}

function drag(card,perfil){
  let startX=0, dx=0;
  card.onpointerdown=e=>{
    startX=e.clientX;
    card.setPointerCapture(e.pointerId);
  };
  card.onpointermove=e=>{
    dx=e.clientX-startX;
    card.style.transform=`translateX(${dx}px) rotate(${dx/15}deg)`;
    likeBadge.style.opacity=dx>0?Math.min(dx/120,1):0;
    skipBadge.style.opacity=dx<0?Math.min(-dx/120,1):0;
  };
  card.onpointerup=()=>{
    if(dx>120) swipe(card,perfil,1);
    else if(dx<-120) swipe(card,perfil,-1);
    else{ card.style.transform=""; likeBadge.style.opacity=0; skipBadge.style.opacity=0; }
    dx=0;
  };
}

function swipe(card, perfil, dir){
  card.style.transform = `translateX(${dir*800}px) rotate(${dir*25}deg)`;
  card.style.opacity = 0;

  if(dir === 1){
   const delay = 10000 + Math.random() * 290000; // 1â€“10 minutos

    setTimeout(() => {
      crearMatch(perfil);
    }, delay);
  }

  setTimeout(() => card.remove(), 500);
}

document.getElementById("btnLike").onclick=()=>{ const c=deckCards[deckCards.length-1]; if(c) swipe(c,PERSONAJES[deckCards.indexOf(c)],1);};
document.getElementById("btnSkip").onclick=()=>{ const c=deckCards[deckCards.length-1]; if(c) swipe(c,PERSONAJES[deckCards.indexOf(c)],-1);};

/* MATCHES */
function yaTieneMatch(nombre){
  return matches.some(m => m.nombre === nombre);
}
function crearMatch(perfil){
  if(matches.find(m => m.nombre === perfil.name)) return;
	const chat = {
	  nombre: perfil.name,
	  img: perfil.img,
	  interes: 50,
	  mensajes: [],
	  elecciones: [...(eleccionesPorPerfil[perfil.name] || [])],
	  paso: 0   
	};

  // ğŸ‘‰ El Ãºltimo match va arriba
  matches.unshift(chat);

  guardarProgreso();
  renderChatList();

  // ğŸ‘‰ Abrir listado de chats
  mostrarAnimacionMatch(perfil, () => {
  abrirListaChats();
  createDeck();
});
}
function abrirListaChats(){
  deck.style.display = "none";
  controls.style.display = "none";
  chatWindow.style.display = "none";
  chatListScreen.style.display = "flex";

  mostrarChatsImg();
  backBtn.style.display = "inline";
}

/* RENDER LISTA CHATS */
function renderChatList(){
  chatListScreen.innerHTML = "";

  matches.forEach(c => {
    const ultimo = c.mensajes[c.mensajes.length - 1];

    const div = document.createElement("div");
    div.className = "chatItem";
    div.innerHTML = `
      <img src="${c.img}">
      <div class="info">
        <div class="name">${c.nombre}</div>
        <div class="lastMsg">${ultimo ? ultimo.texto : ""}</div>
      </div>
    `;

    div.onclick = () => abrirChat(c);
    chatListScreen.appendChild(div);
  });
}
/* ABRIR CHAT */
function abrirChat(chat){
  chatActual = chat;
  deck.style.display = "none";
  controls.style.display = "none";
  chatListScreen.style.display = "none";
  chatWindow.style.display = "flex";

  mostrarTextoTitulo(chat.nombre);
  backBtn.style.display = "inline";

  renderMensajes();
  if(chat.mensajes.length === 0){
	  mostrarPregunta();
	}
}
/* VOLVER ATRÃS */
backBtn.onclick = () => {
  chatWindow.style.display = "none";
  chatListScreen.style.display = "none";
  backBtn.style.display = "none";

  deck.style.display = "flex";
  controls.style.display = "flex";

  mostrarLogo();
};

/* CHAT */
function renderMensajes(){
  chatMsgs.innerHTML="";
  chatActual.mensajes.forEach(m=>{
    const div=document.createElement("div");
    div.className="msg "+m.autor;
    div.innerText=m.texto;
    chatMsgs.appendChild(div);
  });
  chatMsgs.scrollTop=chatMsgs.scrollHeight;
}

function mostrarPregunta(){
  chatOpciones.innerHTML="";

  const paso = chatActual.paso;
  const bloque = chatActual.elecciones[paso];
  if(!bloque) return;

  // ğŸ‘‰ mostrar la pregunta como mensaje de ella
  chatActual.mensajes.push({
    autor:"ella",
    texto: bloque.pregunta
  });
  renderMensajes();

  // ğŸ‘‰ crear botones de respuesta
  bloque.opciones.forEach(op=>{
    const btn=document.createElement("button");
    btn.innerText=op.texto;

    btn.onclick=()=>{
      chatActual.interes += op.efecto || 0;

      // mensaje del jugador
      chatActual.mensajes.push({
        autor:"yo",
        texto: op.texto
      });

      renderMensajes();
      chatOpciones.innerHTML="";

      // ğŸ‘‰ respuesta automÃ¡tica usando "siguiente"
      setTimeout(()=>{
        chatActual.mensajes.push({
          autor:"ella",
          texto: op.siguiente || "..."
        });
        renderMensajes();

        chatActual.paso++;      // avanzar diÃ¡logo
        guardarProgreso();

        setTimeout(mostrarPregunta,800);
      },700);
    };

    chatOpciones.appendChild(btn);
  });
}

function respuestaAuto(){
  if(!chatActual) return;
  let texto="ok";
  if(chatActual.interes>70) texto="Me caes muy bien ğŸ˜";
  else if(chatActual.interes<30) texto="ok";
  chatActual.mensajes.push({autor:"ella",texto});
  renderMensajes();
  mostrarElecciones();
}

/* INPUT */
sendBtn.onclick=()=>{
  const txt=chatInput.value.trim();
  if(!txt) return;
  chatActual.mensajes.push({autor:"yo",texto:txt});
  chatInput.value="";
  renderMensajes();
  setTimeout(respuestaAuto,1000);
  guardarProgreso();
};

/* LOCALSTORAGE */
function guardarProgreso(){
  localStorage.setItem("heartChatRPG",JSON.stringify(matches));
}
function cargarProgreso(){
  const data=localStorage.getItem("heartChatRPG");
  if(!data) return;
  matches=JSON.parse(data);
  renderChatList();
}

/* IR A CHAT LIST */
goChats.onclick = () => {
  deck.style.display = "none";
  controls.style.display = "none";
  chatWindow.style.display = "none";
  chatListScreen.style.display = "flex";

  mostrarChatsImg();
  backBtn.style.display = "inline";
};

/* INICIO */
createDeck();
cargarProgreso();
</script>

</body>
</html>
