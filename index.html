<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
<title>HeartChat RPG ‚Äî Tinder Style</title>

<style>
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%;background:#000;color:white;font-family:Inter,system-ui,Arial;display:flex;justify-content:center;}
.app{width:100%;max-width:420px;height:100vh;display:flex;flex-direction:column;overflow:hidden;}

/* HEADER */
header{padding:14px;display:flex;align-items:center;justify-content:space-between;font-weight:700;}
#backBtn{font-size:1.5rem;cursor:pointer;display:none;}

/* DECK */
.deck{flex:1;position:relative;overflow:hidden;}
.card{position:absolute;inset:10px;border-radius:18px;overflow:hidden;background:#111;box-shadow:0 20px 40px rgba(0,0,0,.4);touch-action:none;transition:transform .3s ease, opacity .3s ease;}
.card img{width:100%;height:100%;object-fit:cover;display:block;}
.overlay{position:absolute;inset:0;background:linear-gradient(to top, rgba(0,0,0,.85) 20%, rgba(0,0,0,.2) 55%, rgba(0,0,0,0) 75%);color:#fff;padding:16px;display:flex;flex-direction:column;justify-content:flex-end;}
.name{font-size:1.4rem;font-weight:800;}
.distance{font-size:.85rem;opacity:.8;margin:4px 0;}
.bio{font-size:.95rem;opacity:.9;}

/* CONTROLS */
.controls{padding:18px 0 26px;display:flex;justify-content:center;gap:26px;}
.circle-btn{width:64px;height:64px;border-radius:50%;border:none;font-size:1.6rem;cursor:pointer;}
.skip{background:#222;color:#ff4458}
.star{background:#222;color:#3b82f6}
.like{background:#222;color:#ff79c6}

/* BADGES */
.badge{position:absolute;top:24px;padding:6px 12px;font-weight:800;border-radius:8px;opacity:0;}
.like-badge{left:20px;background:#22c55e}
.skip-badge{right:20px;background:#ff4458}
.card[data-i="1"]{transform:scale(.97) translateY(8px);opacity:.9}
.card[data-i="2"]{transform:scale(.94) translateY(16px);opacity:.8}

/* CHAT LIST */
#chatListScreen,#chatWindow{display:none;flex-direction:column;flex:1;background:#111;overflow-y:auto;}
.chatItem{display:flex;padding:10px;border-bottom:1px solid #222;cursor:pointer;}
.chatItem img{width:40px;height:40px;border-radius:50%;margin-right:10px;}
.chatItem .info{flex:1;}
.chatItem .name{font-weight:bold;}
.chatItem .lastMsg{font-size:0.85rem;opacity:0.7;}

/* CHAT WINDOW */
#chatMsgs{flex:1;overflow-y:auto;padding:10px;}
.msg{margin:6px 0;padding:6px 10px;border-radius:16px;max-width:70%;}
.msg.yo{background:#ff79c6;align-self:flex-end;}
.msg.ella{background:#333;align-self:flex-start;}
#chatOpciones{display:flex;flex-direction:column;gap:6px;padding:10px;}
#chatInputWrapper{display:flex;padding:10px;}
#chatInput{flex:1;padding:6px 10px;border-radius:12px;border:none;}
#sendBtn{padding:6px 12px;margin-left:6px;border:none;border-radius:12px;background:#ff79c6;color:white;cursor:pointer;}
</style>
</head>

<body>
<div class="app">

<header>
  <span id="backBtn">‚Üê</span>
  <span id="headerTitle">HeartChat RPG</span>
  <span><button id="goChats" style="background:none;border:none;color:white;cursor:pointer;">Chats</button></span>
</header>

<!-- DECK -->
<div class="deck" id="deck">
  <div class="badge like-badge" id="likeBadge">LIKE</div>
  <div class="badge skip-badge" id="skipBadge">NOPE</div>
</div>

<div class="controls" id="controls">
  <button class="circle-btn skip" id="btnSkip">‚úï</button>
  <button class="circle-btn star">‚òÖ</button>
  <button class="circle-btn like" id="btnLike">‚ô•</button>
</div>

<!-- LISTA DE CHATS -->
<div id="chatListScreen"></div>

<!-- VENTANA DE CHAT -->
<div id="chatWindow">
  <div id="chatHeader" style="padding:10px;font-weight:bold;"></div>
  <div id="chatMsgs"></div>
  <div id="chatOpciones"></div>
  <div id="chatInputWrapper">
    <input id="chatInput" placeholder="Escribe...">
    <button id="sendBtn">Enviar</button>
  </div>
</div>

</div>

<script>
/* ===================== DATOS ===================== */
const PERSONAJES=[
  {name:"Leonardo", age:36, distance:"14 km", bio:"Voy al gym casi todos los d√≠as üí™, levanto pesado y hago siempre la misma rutina. Hablo poco üóø, pienso menos. Vivo de prote√≠na, preentreno y frases hechas ü•§. No destaco por mis ideas pero soy constante y f√≠sicamente fuerte üèãÔ∏è‚Äç‚ôÇÔ∏è.", img:"img/gym1.png"},
  {name:"Dylan", age:25, distance:"45 km", bio:"üåä Socorrista de d√≠a, buscador de aventuras de noche. ‚òÄÔ∏è Rubio, con amor por el sol, las olas y los atardeceres en la playa. üèÑ‚Äç‚ôÇÔ∏è Si sabes surfear, tenemos competencia; si no, te ense√±o. üçπ Experto en hacer mojitos y rescatar sonrisas. üí¨ Swipe right si quieres un compa√±ero para paseos en la arena y risas garantizadas.", img:"img/socorrista1.png"},
  {name:"Kaito (‰∏≠Êùë)", age:22, distance:"20 km", bio:"üáØüáµ Soy de Japon, trabajando en cafe tematico en Tokio. ‚úàÔ∏è Ahora en Espa√±a un tiempo, turismo y aprendiendo espa√±ol (aun es un poco dif√≠cil para mi üòÖ). Me gusta mucho servir cafe y hablar con clientes y es arte para mi. Corazon si sabes sitios Espa√±a‚Ä¶ o ayudarme con espa√±ol üòè", img:"img/mayordomo1.png"}
  {name:"Pau Rivas", age:29, distance:"120 km", bio:"Trabajo salvando vidas, pero tambi√©n disfruto viajar, comer bien y desconectar del hospital. Busco conexi√≥n real, risas honestas y alguien con quien sumar, no pasar el tiempo.",  img:"img/medico1.png"},
  {name:"Jan", age:18, distance:"45 km", bio:"Estudiando para ex√°menes pero listo para planes espont√°neos üòå Fan de las noches largas, memes malos y risas reales Swipe si te gusta re√≠rte de la vida (y de los lunes).", img:"img/estudiante1.png"},
  {name:"Park Paujin", age:32, distance:"140 km", bio:"Hago m√∫sica üéßüé∂, escucho K-pop üíø‚ú® y probablemente te dedicar√≠a una canci√≥n sin avisar üíåüéµ Busco a alguien que vibre conmigo üí´, aunque sea fuera de tempo ‚è≥üéº Bonus si cantas en el coche üöóüé§", img:"img/kpoper1.png"}
  {name:"Raven Teo", age:25, distance:"140 km", bio:"No me gustan los chistes ni la gente que los usa para evitar decir algo real. Prefiero el silencio, las conversaciones profundas y la honestidad brutal.", img:"img/gotico2.png"}
];

const eleccionesPorPerfil = {
  "Dylan":[
   {pregunta:"Hola, ¬øsabes nadar o voy a tener que salvarte yo?", opciones:[
    {texto:"M√°s o menos‚Ä¶ dependo de mi flotador.", efecto:5, siguiente: "Jajaja, entonces tu flotador es tu h√©roe secreto üòé "},
    {texto:"No se nadar, as√≠ que tendr√°s que mantenerme a flote‚Ä¶ y de paso, darme tu n√∫mero.", efecto:10, siguiente: "Creo que puedo hacer ambas cosas üòâ "},
    {texto:"¬øPor ser una chica necesito que me salven? Quien te crees...", efecto:-10, siguiente:"No es eso... solo era una excusa para hablar... üòÖ "}
  ]},
  {pregunta:"¬øprefieres empezar en la piscina o en la playa?", opciones:[
    {texto:"Entrenamiento intenso suena bien‚Ä¶ siempre quise hacer que un socorrista corra detr√°s de m√≠", efecto:-10, siguiente: "Ya veo ü§∑ " },
    {texto:"Podemos ir a la piscina‚Ä¶ aunque no prometo no ahogarme.", efecto:5, siguiente: "Bueno, la piscina entonces "},
    {texto:"La playa suena genial, as√≠ puedo practicar nadar y re√≠rme un poco contigo",efecto:10, siguiente: "Bueno, la playa entonces "}
  ]},
    {pregunta:"Pero cuidado, rescatar corazones es m√°s dif√≠cil que nadar.", opciones:[
    {texto:"Espero que no sea demasiado dif√≠cil.", efecto:5, siguiente: "Soy un chico experimentado tu tranquila üòå " },
    {texto:"Entonces me siento en buenas manos.", efecto:10, siguiente: "¬øEn serio lo crees? üí™ "},
    {texto:"Si me ahogo, al menos ser√° dram√°tico.", siguiente: "Bueno... ‚òπÔ∏è " , efecto:-10}
  ]},
  {pregunta:"¬øY t√∫ c√≥mo decides si salvar a alguien o no?", opciones:[
    {texto:"Normalmente dejo que se hundan‚Ä¶ me divierto vi√©ndolo.", efecto:-10, siguiente: "Mi trabajo es evitar que se hundan üòÖ " },
    {texto:"Depende del humor del d√≠a.", efecto:5, siguiente: "Comprendo. "},
    {texto:"Me gu√≠o por la sonrisa‚Ä¶ y creo que contigo ya hay motivo suficiente.", siguiente: "Que bueno üòä " , efecto:10}
  ]},
    {pregunta:"Eso suena peligroso‚Ä¶ pero intrigante", opciones:[
    {texto:"Solo si hay alguien como t√∫ cerca para rescatarme.", efecto:10, siguiente: "Jajaja ya veo, " },
    {texto:"Me gusta ver c√≥mo otros se complican la vida", efecto:-10, siguiente: "Eso no es bueno... "},
    {texto:"Bueno‚Ä¶ un poco de riesgo no mata a nadie, ¬øno?", siguiente: "Supongo que tienes raz√≥n jajaja " , efecto:5}
  ]}
  ],
  "Kaito (‰∏≠Êùë)":[
    {pregunta:"¬øQu√© te gusta hacer?", opciones:[
      {texto:"Ir al gimnasio", efecto:10},
      {texto:"Quedarme en casa", efecto:-5}
    ]}
  ],
  "Leonardo":[
    {pregunta:"Fin de semana favorito?", opciones:[
      {texto:"Salir con amigos", efecto:5},
      {texto:"Quedarme en casa", efecto:-5}
    ]}
  ]
};

/* ===================== VARIABLES ===================== */
const deck=document.getElementById("deck");
const likeBadge=document.getElementById("likeBadge");
const skipBadge=document.getElementById("skipBadge");
const controls=document.getElementById("controls");
const chatListScreen=document.getElementById("chatListScreen");
const chatWindow=document.getElementById("chatWindow");
const chatHeader=document.getElementById("chatHeader");
const chatMsgs=document.getElementById("chatMsgs");
const chatOpciones=document.getElementById("chatOpciones");
const chatInput=document.getElementById("chatInput");
const sendBtn=document.getElementById("sendBtn");
const backBtn=document.getElementById("backBtn");
const goChats=document.getElementById("goChats");
const headerTitle=document.getElementById("headerTitle");

let matches=[];
let chatActual=null;
let deckCards=[];

/* ===================== FUNCIONES ===================== */
function createDeck(){
  deck.innerHTML="";
  deckCards=[];
  PERSONAJES.forEach((p,i)=>{
    const c=document.createElement("div");
    c.className="card";
    c.innerHTML=`
      <img src="${p.img}">
      <div class="overlay">
        <div class="name">${p.name}, ${p.age}</div>
        <div class="distance">${p.distance} away</div>
        <div class="bio">${p.bio}</div>
      </div>`;
    deck.appendChild(c);
    drag(c,p);
    deckCards.push(c);
  });
}

function drag(card,perfil){
  let startX=0, dx=0;
  card.onpointerdown=e=>{
    startX=e.clientX;
    card.setPointerCapture(e.pointerId);
  };
  card.onpointermove=e=>{
    dx=e.clientX-startX;
    card.style.transform=`translateX(${dx}px) rotate(${dx/15}deg)`;
    likeBadge.style.opacity=dx>0?Math.min(dx/120,1):0;
    skipBadge.style.opacity=dx<0?Math.min(-dx/120,1):0;
  };
  card.onpointerup=()=>{
    if(dx>120) swipe(card,perfil,1);
    else if(dx<-120) swipe(card,perfil,-1);
    else{ card.style.transform=""; likeBadge.style.opacity=0; skipBadge.style.opacity=0; }
    dx=0;
  };
}

function swipe(card,perfil,dir){
  card.style.transform=`translateX(${dir*800}px) rotate(${dir*25}deg)`;
  card.style.opacity=0;
  if(dir===1) crearMatch(perfil);
  setTimeout(()=>card.remove(),300);
}

document.getElementById("btnLike").onclick=()=>{ const c=deckCards[deckCards.length-1]; if(c) swipe(c,PERSONAJES[deckCards.indexOf(c)],1);};
document.getElementById("btnSkip").onclick=()=>{ const c=deckCards[deckCards.length-1]; if(c) swipe(c,PERSONAJES[deckCards.indexOf(c)],-1);};

/* MATCHES */
function crearMatch(perfil){
  if(matches.find(m=>m.nombre===perfil.name)) return;
  const chat={nombre:perfil.name,img:perfil.img,interes:50,mensajes:[],elecciones:[...eleccionesPorPerfil[perfil.name]]||[]};
  matches.push(chat);
  guardarProgreso();
  renderChatList();
}

/* RENDER LISTA CHATS */
function renderChatList(){
  chatListScreen.innerHTML="";
  matches.forEach(c=>{
    const div=document.createElement("div");
    div.className="chatItem";
    div.innerHTML=`<img src="${c.img}"><div class="info"><div class="name">${c.nombre}</div><div class="lastMsg">${c.mensajes.slice(-1)[0]?.texto||""}</div></div>`;
    div.onclick=()=>abrirChat(c);
    chatListScreen.appendChild(div);
  });
}

/* ABRIR CHAT */
function abrirChat(chat){
  chatActual=chat;
  deck.style.display="none";
  controls.style.display="none";
  chatListScreen.style.display="none";
  chatWindow.style.display="flex";
  backBtn.style.display="inline";
  headerTitle.innerText=chat.nombre;
  renderMensajes();
  mostrarElecciones();
}

/* VOLVER ATR√ÅS */
backBtn.onclick=()=>{
  chatWindow.style.display="none";
  backBtn.style.display="none";
  deck.style.display="flex";
  controls.style.display="flex";
  headerTitle.innerText="HeartChat RPG";
};

/* CHAT */
function renderMensajes(){
  chatMsgs.innerHTML="";
  chatActual.mensajes.forEach(m=>{
    const div=document.createElement("div");
    div.className="msg "+m.autor;
    div.innerText=m.texto;
    chatMsgs.appendChild(div);
  });
  chatMsgs.scrollTop=chatMsgs.scrollHeight;
}

function mostrarElecciones(){
  chatOpciones.innerHTML="";
  const next=chatActual.elecciones.shift();
  if(!next) return;
  next.opciones.forEach(o=>{
    const btn=document.createElement("button");
    btn.innerText=o.texto;
    btn.onclick=()=>{
      chatActual.interes+=o.efecto;
      chatActual.mensajes.push({autor:"yo",texto:o.texto});
      renderMensajes();
      chatOpciones.innerHTML="";
      setTimeout(respuestaAuto,1000);
      guardarProgreso();
    };
    chatOpciones.appendChild(btn);
  });
}

function respuestaAuto(){
  if(!chatActual) return;
  let texto="ok";
  if(chatActual.interes>70) texto="Me caes muy bien üòè";
  else if(chatActual.interes<30) texto="ok";
  chatActual.mensajes.push({autor:"ella",texto});
  renderMensajes();
  mostrarElecciones();
}

/* INPUT */
sendBtn.onclick=()=>{
  const txt=chatInput.value.trim();
  if(!txt) return;
  chatActual.mensajes.push({autor:"yo",texto:txt});
  chatInput.value="";
  renderMensajes();
  setTimeout(respuestaAuto,1000);
  guardarProgreso();
};

/* LOCALSTORAGE */
function guardarProgreso(){
  localStorage.setItem("heartChatRPG",JSON.stringify(matches));
}
function cargarProgreso(){
  const data=localStorage.getItem("heartChatRPG");
  if(!data) return;
  matches=JSON.parse(data);
  renderChatList();
}

/* IR A CHAT LIST */
goChats.onclick=()=>{
  deck.style.display="none";
  controls.style.display="none";
  chatWindow.style.display="none";
  chatListScreen.style.display="flex";
  headerTitle.innerText="Mis Chats";
  backBtn.style.display="inline";
};

/* INICIO */
createDeck();
cargarProgreso();
</script>

</body>
</html>

